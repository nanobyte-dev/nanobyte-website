# Nanobyte Go API Server

This Go server provides search and latest videos functionality for the Nanobyte Hugo site.

## Features

### 1. Search (`/search`)
- Full-text search through Hugo-generated content
- Searches titles and content
- Server-side HTML rendering matching the Nanobyte theme
- Search index automatically generated during Hugo build

### 2. Latest Videos (`/api/latest-videos`)
- Fetches latest videos from YouTube RSS feed
- Returns server-side rendered HTML fragment
- Can be embedded in iframe or loaded via fetch
- 1-hour cache to avoid excessive YouTube requests

## Configuration

### YouTube Channel ID

To enable the latest videos feature, you need to update the correct YouTube channel ID in `main.go`:

1. Go to your YouTube channel: `https://www.youtube.com/@nanobyte-dev`
2. Click "About" or "View page source"
3. Search for `"channelId"` or `"channel_id"` in the source
4. Copy the channel ID (format: `UC...`)
5. Update line 50 in `main.go`:
   ```go
   youtubeChannelID = "YOUR_ACTUAL_CHANNEL_ID_HERE"
   ```

Alternatively, you can find your channel ID using:
- YouTube Data API
- Online tools like `https://commentpicker.com/youtube-channel-id.php`

### Search Index

The search index is automatically generated by Hugo during the build process:
- Location: `/app/search-index.json`
- Generated from: Hugo's `layouts/_default/index.json` template
- Contains: Page titles, URLs, content excerpts, and sections

## API Endpoints

### GET /search
Returns a full HTML page with search functionality.

**Query Parameters:**
- `q` (optional): Search query string

**Examples:**
- `/search` - Empty search page
- `/search?q=tutorial` - Search for "tutorial"

### GET /api/latest-videos
Returns HTML fragment with latest video cards.

**Response:** HTML that can be embedded in iframe or inserted into page.

### GET /health
Health check endpoint.

**Response:** Plain text "healthy"

## Development

### Local Testing

Build and run with Docker Compose:
```bash
cd /home/tibi/Dev/Nanobyte-Site/HugoRepo
docker compose up --build
```

Access:
- Homepage: http://localhost:8080/
- Search: http://localhost:8080/search
- Videos API: http://localhost:8080/api/latest-videos

### Architecture

The server runs alongside nginx in the same container using supervisord:
- nginx: Serves Hugo static files on port 80
- Go server: Runs on port 3000 (internal only)
- nginx proxies `/search` and `/api/*` to the Go server

## Deployment

The Go server is built as part of the main Dockerfile:
1. Hugo builds static site + search index (stage 1)
2. Go server is compiled (stage 2)
3. Final image runs both nginx and Go server with supervisord

No separate deployment needed - just deploy the main Docker image as usual.

## Styling

Templates use the Nanobyte theme colors:
- Background: `#1e1a2d` (dark purple)
- Panels: `#2d2842` (medium purple)
- Accent/Links: `#F0A9B8` (pink)
- Text: `#ccc` (light gray)

## Troubleshooting

### Videos not showing
- Check that the YouTube channel ID is correct in `main.go:50`
- Verify the RSS feed is accessible: `https://www.youtube.com/feeds/videos.xml?channel_id=YOUR_CHANNEL_ID`
- Check logs: `docker compose logs nanobyte-site`
- The page will gracefully show a fallback message if videos can't be fetched

### Search not working
- Verify search index exists: `docker exec nanobyte-site ls -lh /app/search-index.json`
- Check Hugo is generating JSON output (configured in `config.toml`)
- View logs for errors: `docker compose logs nanobyte-site | grep -i error`

## License

Same as the main Nanobyte site project.
