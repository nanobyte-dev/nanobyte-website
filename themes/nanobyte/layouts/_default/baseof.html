<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if not .IsHome }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>

    {{ with .Description }}
    <meta name="description" content="{{ . }}">
    {{ end }}

    {{ $cssBasic := resources.Get "css/basic.css" }}
    {{ $cssContent := resources.Get "css/content.css" }}
    {{ $cssSyntax := resources.Get "css/syntax.css" }}

    {{/* Process template CSS files with conditionals */}}
    {{ $cssStructureTpl := resources.Get "css/structure.css.tpl" }}
    {{ $cssStructure := $cssStructureTpl | resources.ExecuteAsTemplate "css/structure.css" . }}

    {{ $cssDesignTpl := resources.Get "css/design.css.tpl" }}
    {{ $cssDesign := $cssDesignTpl | resources.ExecuteAsTemplate "css/design.css" . }}

    <link rel="stylesheet" href="{{ $cssBasic.RelPermalink }}">
    <link rel="stylesheet" href="{{ $cssStructure.RelPermalink }}">
    <link rel="stylesheet" href="{{ $cssDesign.RelPermalink }}">
    <link rel="stylesheet" href="{{ $cssSyntax.RelPermalink }}">
    <link rel="stylesheet" href="{{ $cssContent.RelPermalink }}">

    {{ if not .Site.Params.legacyMode }}
        {{/* Mobile CSS only for modern builds */}}
        {{ $cssMobile := resources.Get "css/mobile.css" }}
        <link rel="stylesheet" href="{{ $cssMobile.RelPermalink }}" media="screen and (max-width: 768px)">
    {{ end }}

    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">

    {{ hugo.Generator }}

    <script src="/js/nanobyte.js"></script>
</head>
<body>
    <div id="nb-site">
        <div id="nb-top" class="site">

            {{ partial "header.html" . }}

            <div class="wrapper">

                {{ partial "sidebar.html" . }}

                <div class="main">
                    <main id="nb-content">
                        <div class="page">
                            {{ block "main" . }}{{ end }}
                            <div class="clearer"></div>
                        </div>
                    </main>
                </div>

            </div><!-- /wrapper -->

            {{ partial "footer.html" . }}

        </div>
    </div><!-- /site -->
</body>
</html>
