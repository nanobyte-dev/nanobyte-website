<div class="sidepanel">

    <a id="sidepanel_hamburger" href="#">
        <svg viewBox="0 0 100 80" width="25" height="25">
            <rect fill="#eee" width="100" height="15"></rect>
            <rect fill="#eee" y="35" width="100" height="15"></rect>
            <rect fill="#eee" y="70" width="100" height="15"></rect>
        </svg>
    </a>

    <!-- Search form - TODO: implement server-side search -->
    <form id="dw__search" action="/search/" method="get">
        <div class="no">
            <input type="search" name="q" id="qsearch__in" class="edit" placeholder="Search..." />
            <button type="submit">Search</button>
        </div>
    </form>

    <!-- Sidebar navigation -->
    <aside id="nb-sidebar" aria-label="Sidebar">
        <nav>
            <h3>Navigation</h3>
            <ul>
                <li><a href="/">Home</a></li>

                <!-- Building an OS section -->
                <li>
                    <a href="/building-an-os/" {{ if eq $.RelPermalink "/building-an-os/" }}class="active"{{ end }}>Building an Operating System</a>
                    {{ $currentSection := .CurrentSection }}
                    {{ $buildingOS := .Site.GetPage "/building-an-os" }}
                    {{ if or (eq .Section "building-an-os") (eq .CurrentSection $buildingOS) }}
                    <ul>
                        {{ range $buildingOS.Pages.ByWeight }}
                        <li><a href="{{ .RelPermalink }}" {{ if eq $.RelPermalink .RelPermalink }}class="active"{{ end }}>{{ .Title }}</a></li>
                        {{ end }}
                    </ul>
                    {{ end }}
                </li>

                <!-- OSdev section -->
                <li>
                    <a href="/osdev/" {{ if eq $.RelPermalink "/osdev/" }}class="active"{{ end }}>OS Development</a>
                    {{ $osdev := .Site.GetPage "/osdev" }}
                    {{ if or (eq .Section "osdev") (eq .CurrentSection $osdev) }}
                    <ul>
                        {{ range $osdev.Pages }}
                        <li><a href="{{ .RelPermalink }}" {{ if eq $.RelPermalink .RelPermalink }}class="active"{{ end }}>{{ .Title }}</a></li>
                        {{ end }}
                    </ul>
                    {{ end }}
                </li>

                <!-- Transcripts section -->
                <li>
                    <a href="/transcripts/" {{ if eq $.RelPermalink "/transcripts/" }}class="active"{{ end }}>Video Transcripts</a>
                    {{ $transcripts := .Site.GetPage "/transcripts" }}
                    {{ if or (eq .Section "transcripts") (eq .CurrentSection $transcripts) }}
                    <ul>
                        {{ range $transcripts.Pages }}
                        {{ if not .Params.draft }}
                        <li><a href="{{ .RelPermalink }}" {{ if eq $.RelPermalink .RelPermalink }}class="active"{{ end }}>{{ .Title }}</a></li>
                        {{ end }}
                        {{ end }}
                    </ul>
                    {{ end }}
                </li>

                <li><a href="/sitemap/">All Articles</a></li>
            </ul>
        </nav>
    </aside>

</div>
